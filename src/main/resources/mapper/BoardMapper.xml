<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapbius_server.mapper.BoardMapper">

    <resultMap id="NoticeResultMap" type="com.example.mapbius_server.domain.Board">
        <result column="id" property="id" />
        <result column="title" property="title" />
        <result column="content" property="content" />
        <result column="author" property="author" />
        <result column="created_date" property="createdDate" />
        <result column="updated_date" property="updatedDate" />
    </resultMap>



    <!-- 공지사항 등록 -->
    <insert id="insertNotice" parameterType="com.example.mapbius_server.domain.Board">
        INSERT INTO notices (title, content, author, created_date, updated_date)
        VALUES (#{title}, #{content}, #{author}, NOW(), NOW());
    </insert>

    <!-- 공지사항 삭제 -->
    <delete id="deleteNotice">
        DELETE FROM notices WHERE id = #{id};
    </delete>

    <!-- 공지사항 수정 -->
    <update id="updateNotice" parameterType="com.example.mapbius_server.domain.Board">
        UPDATE notices
        SET title = #{title},
            content = #{content},
            updated_date = NOW()
        WHERE id = #{id};
    </update>

    <!-- 공지사항 목록 조회 -->
    <select id="selectNoticeList" resultType="com.example.mapbius_server.domain.Board">
        SELECT id, title, content, author, created_date, updated_date
        FROM notices
        ORDER BY created_date DESC;
    </select>

    <!-- 공지사항 상세 조회 -->
    <select id="selectNoticeById" parameterType="int" resultType="com.example.mapbius_server.domain.Board">
        SELECT id, title, content, author, created_date, updated_date
        FROM notices
        WHERE id = #{id};
    </select>

    <!-- 공지사항 검색 -->
    <select id="searchNotices" parameterType="String" resultType="com.example.mapbius_server.domain.Board">
        SELECT id, title, content, author, created_date, updated_date
        FROM notices
        WHERE title LIKE CONCAT('%', #{keyword}, '%') OR content LIKE CONCAT('%', #{keyword}, '%')
        ORDER BY created_date DESC;
    </select>

    <!-- 공지사항 페이징 -->
    <select id="selectNoticeListPaging" resultType="com.example.mapbius_server.domain.Board">
        SELECT id, title, content, author, created_date, updated_date
        FROM notices
        ORDER BY created_date DESC
            LIMIT #{limit} OFFSET #{offset};
    </select>

</mapper>
